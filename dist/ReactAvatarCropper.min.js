!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("react-dom"),require("react-bootstrap")):"function"==typeof define&&define.amd?define(["react","react-dom","react-bootstrap"],t):"object"==typeof exports?exports.ReactAvatarCropper=t(require("react"),require("react-dom"),require("react-bootstrap")):e.ReactAvatarCropper=t(e.react,e["react-dom"],e["react-bootstrap"])}(this,function(e,t,r){return function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){e.exports=r(1)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(e,t,r){for(var n=!0;n;){var o=e,a=t,i=r;n=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,a);if(void 0!==s){if("value"in s)return s.value;var u=s.get;if(void 0===u)return;return u.call(i)}var p=Object.getPrototypeOf(o);if(null===p)return;e=p,t=a,r=i,n=!0,s=p=void 0}};r(2);var u=r(6),p=n(u),d=r(7),c=n(d),l=r(8),h=r(9),f=r(10),m=n(f),v=function(e,t,r){(0,m.default)(!isNaN(parseInt(e[t])),"Invalid "+t+" '"+e.size+"' sent to '"+r+"'. Requires an\n    int or string capable of conversion to an int.\n    Check the render method of == '"+r+"'. == ")},g=function(e){function t(){o(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this),this.state={dragging:!1,image:{},mouse:{x:null,y:null},preview:null,originalPreview:null,zoom:1},this.listeners=[]}return a(t,e),i(t,[{key:"fitImageToCanvas",value:function(e,t){var r,n,o=this.props.height/this.props.width,a=t/e;if(o>a){r=this.props.height;var i=r/t;n=e*i}else{n=this.props.width;var i=n/e;r=t*i}return{width:n,height:r}}},{key:"prepareImage",value:function(e){var t=this,r=new Image;(0,h.isDataURL)(e)||(r.crossOrigin="anonymous"),r.onload=function(){var e=t.fitImageToCanvas(r.width,r.height);e.resource=r,e.x=0,e.y=0,t.setState({dragging:!1,image:e,preview:t.toDataURL()}),null===t.state.originalPreview&&t.setState({originalPreview:t.state.preview})},r.src=e}},{key:"mouseDownListener",value:function(e){this.setState({image:this.state.image,dragging:!0,mouse:{x:null,y:null}})}},{key:"preventSelection",value:function(e){if(this.state.dragging)return e.preventDefault(),!1}},{key:"mouseUpListener",value:function(e){this.setState({dragging:!1,preview:this.toDataURL()})}},{key:"mouseMoveListener",value:function(e){if(this.state.dragging){var t=e.clientX,r=e.clientY,n=this.state.image.x,o=this.state.image.y,a=this.state.image;if(this.state.mouse.x&&this.state.mouse.y){var i=this.state.mouse.x-t,s=this.state.mouse.y-r,u=this.boundedCoords(n,o,i,s);a.x=u.x,a.y=u.y}this.setState({image:this.state.image,mouse:{x:t,y:r}})}}},{key:"boundedCoords",value:function(e,t,r,n){var o=e-r,a=t-n,i=this.state.image.width*this.state.zoom,s=(i-this.state.image.width)/2,u=(this.state.image.x-s,this.props.width);e=o-s>0?s:o<-i+u?u-i:o;var p=this.state.image.height*this.state.zoom,d=(p-this.state.image.height)/2,c=(this.state.image.y-d,this.props.height);return t=a-d>0?d:a<-p+c?c-p:a,{x:e,y:t}}},{key:"componentDidMount",value:function(){var e=this,t=c.default.findDOMNode(this.refs.canvas);t.getContext("2d");this.prepareImage(this.props.image),this.listeners={mousemove:function(t){return e.mouseMoveListener(t)},mouseup:function(t){return e.mouseUpListener(t)},mousedown:function(t){return e.mouseDownListener(t)}},window.addEventListener("mousemove",this.listeners.mousemove,!1),window.addEventListener("mouseup",this.listeners.mouseup,!1),t.addEventListener("mousedown",this.listeners.mousedown,!1),document.onselectstart=function(t){return e.preventSelection(t)}}},{key:"componentWillUnmount",value:function(){var e=c.default.findDOMNode(this.refs.canvas);window.removeEventListener("mousemove",this.listeners.mousemove),window.removeEventListener("mouseup",this.listeners.mouseup),e.removeEventListener("mousedown",this.listeners.mousedown)}},{key:"componentDidUpdate",value:function(){var e=c.default.findDOMNode(this.refs.canvas).getContext("2d");e.clearRect(0,0,this.props.width,this.props.height),this.addImageToCanvas(e,this.state.image)}},{key:"addImageToCanvas",value:function(e,t){if(t.resource){e.save(),e.globalCompositeOperation="destination-over";var r=this.state.image.width*this.state.zoom,n=this.state.image.height*this.state.zoom,o=t.x-(r-this.state.image.width)/2,a=t.y-(n-this.state.image.height)/2;o=Math.min(o,0),a=Math.min(a,0),a=n+a>=this.props.height?a:a+(this.props.height-(n+a)),o=r+o>=this.props.width?o:o+(this.props.width-(r+o)),e.drawImage(t.resource,o,a,t.width*this.state.zoom,t.height*this.state.zoom),e.restore()}}},{key:"toDataURL",value:function(){var e=document.createElement("canvas"),t=e.getContext("2d");return e.width=this.props.width,e.height=this.props.height,this.addImageToCanvas(t,{resource:this.state.image.resource,x:this.state.image.x,y:this.state.image.y,height:this.state.image.height,width:this.state.image.width}),e.toDataURL()}},{key:"handleCrop",value:function(){var e=this.toDataURL();this.props.onCrop(e)}},{key:"handleZoomUpdate",value:function(){var e=this.state;e.zoom=c.default.findDOMNode(this.refs.zoom).value,this.setState({newstate:e})}},{key:"resetImage",value:function(e){var t=this,r=this.refs.canvas,n=this.refs.canvas.getContext("2d"),o=new Image;o.onload=function(){c.default.findDOMNode(t.refs.zoom).value=1,t.handleZoomUpdate(),n.drawImage(o,0,0),t.prepareImage(r.toDataURL()),e()},o.src=this.state.originalPreview}},{key:"handleRotateLeft",value:function(){var e=this,t=c.default.findDOMNode(this.refs.zoom).value;return this.resetImage(function(){var r=e.refs.canvas,n=e.refs.canvas.getContext("2d"),o=new Image;o.onload=function(){n.save(),n.translate(r.width/2,r.height/2),n.rotate(270*Math.PI/180),n.drawImage(o,-o.width/2,-o.width/2),n.restore(),c.default.findDOMNode(e.refs.zoom).value=t,e.prepareImage(r.toDataURL()),e.handleZoomUpdate()},o.src=r.toDataURL()})}},{key:"handleRotateRight",value:function(){var e=this,t=c.default.findDOMNode(this.refs.zoom).value;return this.resetImage(function(){var r=e.refs.canvas,n=e.refs.canvas.getContext("2d"),o=new Image;o.onload=function(){n.save(),n.translate(r.width/2,r.height/2),n.rotate(90*Math.PI/180),n.drawImage(o,-o.width/2,-o.width/2),n.restore(),c.default.findDOMNode(e.refs.zoom).value=t,e.prepareImage(r.toDataURL()),e.handleZoomUpdate()},o.src=r.toDataURL()})}},{key:"render",value:function(){return p.default.createElement("div",{className:"AvatarCropper-canvas"},p.default.createElement("div",{className:"row"},p.default.createElement("canvas",{ref:"canvas",width:this.props.width,height:this.props.height})),p.default.createElement("div",{className:"row rotate-btns"},p.default.createElement("div",{className:"col-md-6"},p.default.createElement(l.Button,{bsStyle:"info",onClick:this.handleRotateLeft.bind(this)},"Rotate Left")),p.default.createElement("div",{className:"col-md-6 pull-right"},p.default.createElement(l.Button,{bsStyle:"info",onClick:this.handleRotateRight.bind(this)},"Rotate Right"))),p.default.createElement("div",{className:"row"},p.default.createElement("input",{type:"range",name:"zoom",ref:"zoom",onChange:this.handleZoomUpdate.bind(this),style:{width:this.props.width},min:"1",max:"3",step:"0.01",defaultValue:"1"})),p.default.createElement("div",{className:"modal-footer"},p.default.createElement(l.Button,{onClick:this.props.onRequestHide},"Close"),p.default.createElement(l.Button,{bsStyle:"primary",onClick:this.handleCrop.bind(this)},"Crop and Save")))}}]),t}(p.default.Component);g.propTypes={image:p.default.PropTypes.string.isRequired,width:v,height:v,zoom:v},g.defaultProps={width:400,height:400,zoom:1};var y=function(e){function t(){o(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this)}return a(t,e),i(t,[{key:"handleZoomUpdate",value:function(){var e=c.default.findDOMNode(this.refs.zoom).value;this.setState({zoom:e})}},{key:"render",value:function(){return p.default.createElement(l.Modal,{title:"Crop It",onHide:this.props.onRequestHide,show:this.props.cropperOpen,backdrop:!1},p.default.createElement("div",{className:"modal-body"},p.default.createElement("div",{className:"AvatarCropper-base"},p.default.createElement(g,{image:this.props.image,width:this.props.width,height:this.props.height,onCrop:this.props.onCrop,onRequestHide:this.props.onRequestHide}))))}}]),t}(p.default.Component);y.propTypes={image:p.default.PropTypes.string.isRequired,onCrop:p.default.PropTypes.func.isRequired,width:v,height:v,onRequestHide:p.default.PropTypes.func.isRequired},y.defaultProps={width:400,height:400},t.default=y,e.exports=t.default},function(e,t,r){var n=r(3);"string"==typeof n&&(n=[[e.id,n,""]]);r(5)(n,{});n.locals&&(e.exports=n.locals)},function(e,t,r){t=e.exports=r(4)(),t.push([e.id,".AvatarCropper-base{text-align:center}.AvatarCropper-base input[type=range]{display:inline-block;-webkit-appearance:none;padding:20px 0;border:1px solid #fff;width:400px}.AvatarCropper-base input[type=range]::-webkit-slider-runnable-track{width:400px;height:5px;background:#ddd;border:none;border-radius:3px}.AvatarCropper-base input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;border:none;height:16px;width:16px;border-radius:50%;background:#454545;margin-top:-4px}.AvatarCropper-base input[type=range]:focus{outline:0}.AvatarCropper-base input[type=range]:focus::-webkit-slider-runnable-track{background:#ccc}.AvatarCropper-base input[type=range]::-moz-range-track{width:400px;height:5px;background:#ddd;border:none;border-radius:3px}.AvatarCropper-base input[type=range]::-moz-range-thumb{border:none;height:16px;width:16px;border-radius:50%;background:#454545}.AvatarCropper-base input[type=range]:-moz-focusring{outline:#fff solid 1px;outline-offset:-1px}.AvatarCropper-base input[type=range]::-ms-track{width:400px;height:5px;background:0 0;border-color:transparent;border-width:6px 0;color:transparent}.AvatarCropper-base input[type=range]::-ms-fill-lower{background:#777;border-radius:10px}.AvatarCropper-base input[type=range]::-ms-fill-upper{background:#ddd;border-radius:10px}.AvatarCropper-base input[type=range]::-ms-thumb{border:none;height:16px;width:16px;border-radius:50%;background:#454545}.AvatarCropper-base input[type=range]:focus::-ms-fill-lower{background:#888}.AvatarCropper-base input[type=range]:focus::-ms-fill-upper{background:#ccc}.AvatarCropper-base canvas{cursor:move}",""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var r=this[t];r[2]?e.push("@media "+r[2]+"{"+r[1]+"}"):e.push(r[1])}return e.join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},o=0;o<this.length;o++){var a=this[o][0];"number"==typeof a&&(n[a]=!0)}for(o=0;o<t.length;o++){var i=t[o];"number"==typeof i[0]&&n[i[0]]||(r&&!i[2]?i[2]=r:r&&(i[2]="("+i[2]+") and ("+r+")"),e.push(i))}},e}},function(e,t,r){function n(e,t){for(var r=0;r<e.length;r++){var n=e[r],o=c[n.id];if(o){o.refs++;for(var a=0;a<o.parts.length;a++)o.parts[a](n.parts[a]);for(;a<n.parts.length;a++)o.parts.push(s(n.parts[a],t))}else{for(var i=[],a=0;a<n.parts.length;a++)i.push(s(n.parts[a],t));c[n.id]={id:n.id,refs:1,parts:i}}}}function o(e){for(var t=[],r={},n=0;n<e.length;n++){var o=e[n],a=o[0],i=o[1],s=o[2],u=o[3],p={css:i,media:s,sourceMap:u};r[a]?r[a].parts.push(p):t.push(r[a]={id:a,parts:[p]})}return t}function a(){var e=document.createElement("style"),t=f();return e.type="text/css",t.appendChild(e),e}function i(){var e=document.createElement("link"),t=f();return e.rel="stylesheet",t.appendChild(e),e}function s(e,t){var r,n,o;if(t.singleton){var s=v++;r=m||(m=a()),n=u.bind(null,r,s,!1),o=u.bind(null,r,s,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=i(),n=d.bind(null,r),o=function(){r.parentNode.removeChild(r),r.href&&URL.revokeObjectURL(r.href)}):(r=a(),n=p.bind(null,r),o=function(){r.parentNode.removeChild(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else o()}}function u(e,t,r,n){var o=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=g(t,o);else{var a=document.createTextNode(o),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}function p(e,t){var r=t.css,n=t.media;t.sourceMap;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}function d(e,t){var r=t.css,n=(t.media,t.sourceMap);n&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var o=new Blob([r],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(o),a&&URL.revokeObjectURL(a)}var c={},l=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},h=l(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),f=l(function(){return document.head||document.getElementsByTagName("head")[0]}),m=null,v=0;e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=h());var r=o(e);return n(r,t),function(e){for(var a=[],i=0;i<r.length;i++){var s=r[i],u=c[s.id];u.refs--,a.push(u)}if(e){var p=o(e);n(p,t)}for(var i=0;i<a.length;i++){var u=a[i];if(0===u.refs){for(var d=0;d<u.parts.length;d++)u.parts[d]();delete c[u.id]}}}};var g=function(){var e=[];return function(t,r){return e[t]=r,e.filter(Boolean).join("\n")}}()},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){"use strict";function r(e){return!!e.match(r.regex)}Object.defineProperty(t,"__esModule",{value:!0}),t.isDataURL=r,r.regex=/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i},function(e,t,r){(function(t){"use strict";var r=function(){};"production"!==t.env.NODE_ENV&&(r=function(e,t,r){var n=arguments.length;r=new Array(n>2?n-2:0);for(var o=2;o<n;o++)r[o-2]=arguments[o];if(void 0===t)throw new Error("`warning(condition, format, ...args)` requires a warning message argument");if(t.length<10||/^[s\W]*$/.test(t))throw new Error("The warning format should be able to uniquely identify this warning. Please, use a more descriptive format than: "+t);if(!e){var a=0,i="Warning: "+t.replace(/%s/g,function(){return r[a++]});"undefined"!=typeof console&&console.error(i);try{throw new Error(i)}catch(e){}}}),e.exports=r}).call(t,r(11))},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(d===setTimeout)return setTimeout(e,0);if((d===r||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function a(e){if(c===clearTimeout)return clearTimeout(e);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}function i(){m&&h&&(m=!1,h.length?f=h.concat(f):v=-1,f.length&&s())}function s(){if(!m){var e=o(i);m=!0;for(var t=f.length;t;){for(h=f,f=[];++v<t;)h&&h[v].run();v=-1,t=f.length}h=null,m=!1,a(e)}}function u(e,t){this.fun=e,this.array=t}function p(){}var d,c,l=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:r}catch(e){d=r}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(e){c=n}}();var h,f=[],m=!1,v=-1;l.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new u(e,t)),1!==f.length||m||o(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=p,l.addListener=p,l.once=p,l.off=p,l.removeListener=p,l.removeAllListeners=p,l.emit=p,l.binding=function(e){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}}])});